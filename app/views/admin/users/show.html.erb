<h1>Admin Dashboard</h1>
<h2>All Orders</h2>

<table id="subtotals">
  <tr>
    <th><%= link_to "All", admin_dashboard_path %></th>
    <% @statuses.each do |status| %>
      <th>
        <%= link_to status.capitalize, admin_dashboard_path(status: status) %>
      </th>
    <% end %>
  </tr>
  <tr>
    <td><%= @counts["all"]%></td>
    <td><%= @counts["ordered"]%></td>
    <td><%= @counts["paid"]%></td>
    <td><%= @counts["completed"]%></td>
    <td><%= @counts["cancelled"]%></td>
  </tr>
</table>

<table>
  <tr>
    <th>Order Number</th>
    <th>Order Date</th>
    <th>Order Total</th>
    <th>Order Status</th>
    <th>View Details</th>
  </tr>
  <% @orders.each do |order| %>
    <tr id=order-<%= order.id %>>
      <td id=id-<%= order.id %>><%= order.id %></td>
      <td><%= order.display_status %></td>
      <td><%= link_to "View Order", order_path(order) %></td>
      <td >
        <% unless order.completed? || order.cancelled? %>
          <%= form_for order, url: admin_order_path(order), method: :put do |f| %>
            <%= f.submit "Mark as #{order.next_status}" %>
          <% end %>
        <% end %>

        <% if order.cancellable? %>
          <%= form_for order, url: admin_order_path(order), method: :delete do |f| %>
          <%= f.submit "Mark as cancelled" %>
          <% end %>
        <% end %>
      </td>
    </tr>
  <% end %>
</table>
